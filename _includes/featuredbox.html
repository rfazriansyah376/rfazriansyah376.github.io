<style>
.recent-posts {
  margin: 2rem auto;
  padding: 0 1rem;
  max-width: 1200px;
}

.recent-posts h2 {
  font-size: 1.5rem;
  text-align: center;
  margin-bottom: 1.5rem;
  color: #333;
}

/* Horizontal scroll container */
.horizontal-scroll-container {
  display: flex;
  overflow-x: auto;
  gap: 1rem;
  padding: 1rem 0;
  scrollbar-width: thin;
  scrollbar-color: #ccc transparent;
  -webkit-overflow-scrolling: touch;
}

/* Hide scrollbar for Chrome, Safari and Opera */
.horizontal-scroll-container::-webkit-scrollbar {
  height: 4px;
}
.horizontal-scroll-container::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 2px;
}
.horizontal-scroll-container::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 2px;
}

/* Post card styles untuk tampilan horizontal */
.post-card {
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  padding: 1.2rem;
  display: flex;
  flex-direction: column;
  min-width: 280px;
  max-width: 280px;
  flex-shrink: 0;
  border: 1px solid #eee;
}
.post-card h3 {
  font-size: 1.1rem;
  margin-bottom: 0.5rem;
}
.post-card h3 a {
  text-decoration: none;
  color: #222;
}
.post-card h3 a:hover {
  color: #0078ff;
}
.post-card p {
  font-size: 0.9rem;
  line-height: 1.5;
  color: #555;
  margin: 0;
}

@media (max-width: 600px) {
  .horizontal-scroll-container {
    gap: 0.8rem;
  }
  .post-card {
    min-width: 250px;
    max-width: 250px;
    padding: 1rem;
  }
}
</style>

<section class="recent-posts">      
  <div id="recent-posts-container" class="horizontal-scroll-container"></div>      
</section>      

<script>
function getCategoryCandidates(hostname) {      
  const parts = hostname.split('.');      
  if (parts.length < 2) return { sub: null, domain: null };      
  const maybeDomainIndex = parts.length - 3;      
  const domain = (maybeDomainIndex >= 0) ? parts[maybeDomainIndex] : parts[0];      
  const subLabels = (maybeDomainIndex > 0) ? parts.slice(0, maybeDomainIndex) : [];      
  const rawSub = subLabels.length ? subLabels.join('.') : null;      
  const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
  return { sub: rawSub ? normalize(rawSub) : null, domain: domain ? normalize(domain) : null };      
}      

const { sub: subCategory, domain: domainCategory } = getCategoryCandidates(window.location.hostname);      
let filteredPosts = [];      

fetch('/posts.json')      
  .then(res => {      
    if (!res.ok) throw new Error('Failed to load posts.json');      
    return res.json();      
  })      
  .then(posts => {      
    const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
    if (!Array.isArray(posts) || posts.length === 0) return renderNoPosts();      

    if (subCategory) {      
      filteredPosts = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === subCategory));      
    }      

    if (filteredPosts.length === 0 && domainCategory) {      
      filteredPosts = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === domainCategory));      
    }      

    if (filteredPosts.length === 0) filteredPosts = posts;      

    filteredPosts.sort((a, b) => new Date(b.date) - new Date(a.date));      
    renderPosts();      
  })      
  .catch(err => {      
    console.error('Error loading posts:', err);      
    renderNoPosts();      
  });      

function renderPosts() {      
  const container = document.getElementById('recent-posts-container');      
  container.innerHTML = '';      

  filteredPosts.forEach(post => {      
    const card = document.createElement('div');      
    card.className = 'post-card';      

    const h3 = document.createElement('h3');      
    const linkTitle = document.createElement('a');      
    linkTitle.href = post.url || '#';      
    linkTitle.textContent = post.title || '(no title)';      
    h3.appendChild(linkTitle);      
    card.appendChild(h3);      

    const desc = document.createElement('p');      
    desc.textContent = post.excerpt || '(no excerpt available)';      
    card.appendChild(desc);      

    container.appendChild(card);      
  });      
}      

function renderNoPosts() {      
  const container = document.getElementById('recent-posts-container');      
  container.innerHTML = '<p>No posts found.</p>';      
}      
</script>
