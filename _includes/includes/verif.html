<!-- spo universal verif include (HEAD SAFE) -->
<script>
(function() {
  function whenBodyReady(cb) {
    if (document.body) {
      cb();
    } else {
      setTimeout(function() {
        whenBodyReady(cb);
      }, 20);
    }
  }

  function run() {
    const host = window.location.hostname.toLowerCase();
    const parts = host.split(".");
    const clean = v => v.replace(/[^a-z0-9\-]/g, "");

    let container = document.getElementById("spo-verif-dynamic-include");

    if (!container) {
      container = document.createElement("div");
      container.id = "spo-verif-dynamic-include";
      container.className = "spo-verif";
      container.setAttribute("loading", "lazy");
      document.body.appendChild(container);
    }

    const files = [];
    const fallback = "fallback.html";

    /* ===== PLATFORM PRIORITY ===== */
    if (host.endsWith("github.io")) {
      files.push("github.html");
    } else if (host.endsWith("pages.dev")) {
      files.push("pages.html");
    } else {
      const sub = parts.length > 2 ? clean(parts[0]) : null;
      const dom = parts.length > 1
        ? clean(parts[parts.length - 2])
        : clean(parts[0]);

      if (sub) files.push(sub + ".html");
      files.push(dom + ".html");
    }

    files.push(fallback);

    function load(list) {
      if (!list.length) return;
      const file = list.shift();
      fetch("/verif/" + file)
        .then(r => {
          if (!r.ok) throw new Error("skip");
          return r.text();
        })
        .then(html => {
          container.innerHTML = html;
        })
        .catch(() => load(list));
    }

    load(files);
  }

  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", function() {
      whenBodyReady(run);
    });
  } else {
    whenBodyReady(run);
  }
})();
</script>
<!-- end spo universal verif -->
