
<style>
.recent-posts-horizontal {
  margin: 3rem auto;
  padding: 0 1rem;
  max-width: 1400px;
  position: relative;
  overflow: hidden;
}

/* Header dengan gradient */
.recent-posts-header {
  text-align: center;
  margin-bottom: 3rem;
  position: relative;
}

.recent-posts-title {
  font-size: 2.5rem;
  font-weight: 800;
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  margin-bottom: 0.5rem;
  letter-spacing: -0.5px;
}

.recent-posts-subtitle {
  color: #666;
  font-size: 1.1rem;
  max-width: 600px;
  margin: 0 auto;
  line-height: 1.6;
  font-weight: 300;
}

/* Main container dengan navigation buttons di samping */
.stories-container-wrapper {
  position: relative;
  display: flex;
  align-items: center;
  gap: 20px;
  padding: 20px 0;
}

/* Navigation buttons di samping */
.nav-btn-side {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  z-index: 100;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 50%;
  width: 56px;
  height: 56px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 1.5rem;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
  box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
  opacity: 0.9;
}

.nav-btn-side:hover:not(:disabled) {
  opacity: 1;
  transform: translateY(-50%) scale(1.1);
  box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
}

.nav-btn-side:disabled {
  background: linear-gradient(135deg, #cccccc 0%, #aaaaaa 100%);
  color: #888;
  cursor: not-allowed;
  transform: translateY(-50%);
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  opacity: 0.5;
}

.nav-btn-side.left {
  left: -28px;
}

.nav-btn-side.right {
  right: -28px;
}

/* Container utama untuk stories */
.stories-main-container {
  flex: 1;
  position: relative;
  overflow: visible;
}

/* Horizontal scroll container dengan 2 kolom */
.horizontal-posts-scroll {
  display: flex;
  overflow-x: auto;
  gap: 2rem;
  padding: 2rem 1.5rem;
  scrollbar-width: none;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
  scroll-padding: 0 1.5rem;
}

/* Hide scrollbar */
.horizontal-posts-scroll::-webkit-scrollbar {
  display: none;
}

/* Tampilkan 2 kolom dalam viewport - Lebih besar untuk story feel */
.horizontal-posts-scroll .story-card {
  width: calc(50% - 1rem);
  min-width: calc(50% - 1rem);
  max-width: calc(50% - 1rem);
  flex-shrink: 0;
  position: relative;
  overflow: visible;
}

/* Story card dengan gradient border seperti Instagram */
.story-card {
  background: linear-gradient(145deg, #ffffff, #f8f9fa);
  border-radius: 20px;
  overflow: hidden;
  padding: 2.5rem 2rem;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
  border: 2px solid transparent;
  position: relative;
  min-height: 380px;
  box-shadow: 
    0 15px 35px rgba(0, 0, 0, 0.1),
    inset 0 1px 0 rgba(255, 255, 255, 0.8);
}

/* Gradient border untuk story card */
.story-card::before {
  content: '';
  position: absolute;
  top: -3px;
  left: -3px;
  right: -3px;
  bottom: -3px;
  background: linear-gradient(45deg, 
    #f093fb 0%, #f5576c 25%, 
    #4ecdc4 50%, #45b7d1 75%, 
    #96ceb4 100%);
  border-radius: 22px;
  z-index: -1;
  opacity: 0.7;
  transition: opacity 0.5s ease;
}

.story-card:hover::before {
  opacity: 1;
}

/* Story profile circle (seperti di Instagram) */
.story-profile {
  position: absolute;
  top: -30px;
  left: 50%;
  transform: translateX(-50%);
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
  border: 4px solid white;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
  transition: transform 0.3s ease;
}

.story-card:hover .story-profile {
  transform: translateX(-50%) scale(1.1);
}

.story-profile-icon {
  color: white;
  font-size: 1.5rem;
  font-weight: bold;
}

/* Story content */
.story-content {
  margin-top: 2rem;
  flex: 1;
}

.story-date {
  font-size: 0.9rem;
  color: #f5576c;
  margin-bottom: 1rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  justify-content: center;
}

.story-date::before {
  content: 'üìÖ';
  font-size: 1rem;
}

.story-card h3 {
  font-size: 1.4rem;
  margin-bottom: 1.2rem;
  text-align: center;
  background: linear-gradient(135deg, #333 0%, #666 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  font-weight: 700;
  line-height: 1.4;
  min-height: 3.5rem;
}

.story-card h3 a {
  text-decoration: none;
  color: inherit;
  transition: all 0.3s ease;
}

.story-card h3 a:hover {
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.story-card p {
  font-size: 1rem;
  line-height: 1.7;
  color: #555;
  margin: 0 0 1.5rem 0;
  display: -webkit-box;
  -webkit-line-clamp: 4;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-align: center;
}

/* Story categories tags */
.story-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 0.6rem;
  justify-content: center;
  margin-top: 1.5rem;
}

.story-tag {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 0.4rem 1rem;
  border-radius: 25px;
  font-size: 0.8rem;
  font-weight: 500;
  text-decoration: none;
  transition: all 0.3s ease;
  border: 2px solid transparent;
}

.story-tag:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
  border-color: white;
}

/* Read more button */
.story-read-more {
  display: inline-block;
  margin: 1.5rem auto 0;
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  color: white;
  padding: 0.8rem 2rem;
  border-radius: 25px;
  text-decoration: none;
  font-weight: 600;
  font-size: 0.9rem;
  transition: all 0.3s ease;
  text-align: center;
  border: 2px solid transparent;
  max-width: 200px;
}

.story-read-more:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 25px rgba(240, 147, 251, 0.4);
  border-color: white;
}

/* Page indicator dots - Instagram story style */
.page-indicators-stories {
  display: flex;
  gap: 0.8rem;
  align-items: center;
  justify-content: center;
  margin-top: 2.5rem;
  padding: 0 1rem;
}

.page-dot-story {
  width: 40px;
  height: 6px;
  border-radius: 3px;
  background: rgba(0, 0, 0, 0.1);
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.1);
  cursor: pointer;
  position: relative;
  overflow: hidden;
}

.page-dot-story::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
  border-radius: 3px;
  transform: scaleX(0);
  transform-origin: left;
  transition: transform 0.4s ease;
}

.page-dot-story.active::before {
  transform: scaleX(1);
}

.page-dot-story:hover {
  background: rgba(0, 0, 0, 0.2);
}

/* Floating animation untuk story cards */
@keyframes storyFloat {
  0% { transform: translateY(0px); }
  50% { transform: translateY(-15px); }
  100% { transform: translateY(0px); }
}

.story-card:nth-child(odd) {
  animation: storyFloat 6s ease-in-out infinite;
}

.story-card:nth-child(even) {
  animation: storyFloat 6s ease-in-out infinite 1.5s;
}

/* Progress bar animation (Instagram story progress) */
@keyframes progress {
  0% { width: 0%; }
  100% { width: 100%; }
}

/* Responsive adjustments */
@media (max-width: 1200px) {
  .stories-container-wrapper {
    padding: 20px 40px;
  }
  
  .nav-btn-side {
    position: relative;
    top: auto;
    transform: none;
  }
  
  .nav-btn-side.left {
    left: 0;
  }
  
  .nav-btn-side.right {
    right: 0;
  }
}

@media (max-width: 768px) {
  .recent-posts-title {
    font-size: 2rem;
  }
  
  .stories-container-wrapper {
    padding: 20px;
  }
  
  .horizontal-posts-scroll .story-card {
    width: calc(100% - 1rem);
    min-width: calc(100% - 1rem);
    max-width: calc(100% - 1rem);
  }
  
  .story-card {
    min-height: 350px;
    padding: 2rem 1.5rem;
  }
  
  .nav-btn-side {
    width: 48px;
    height: 48px;
    font-size: 1.3rem;
  }
  
  .story-profile {
    width: 50px;
    height: 50px;
    top: -25px;
  }
  
  .page-dot-story {
    width: 30px;
    height: 5px;
  }
}

@media (max-width: 480px) {
  .recent-posts-title {
    font-size: 1.8rem;
  }
  
  .stories-container-wrapper {
    padding: 10px;
    gap: 10px;
  }
  
  .story-card {
    min-height: 320px;
    padding: 1.8rem 1.2rem;
  }
  
  .story-card h3 {
    font-size: 1.2rem;
  }
  
  .nav-btn-side {
    width: 40px;
    height: 40px;
    font-size: 1.1rem;
  }
  
  .story-card {
    animation: none !important;
  }
}

/* Loading animation */
@keyframes shimmer {
  0% { background-position: -1000px 0; }
  100% { background-position: 1000px 0; }
}

.loading-shimmer {
  background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
  background-size: 1000px 100%;
  animation: shimmer 2s infinite linear;
}

/* SVG Icons */
.svg-icon {
  width: 24px;
  height: 24px;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}
</style>

<section class="recent-posts-horizontal">
  <div class="recent-posts-header">
    <h2 class="recent-posts-title">Instagram Stories Style</h2>
    <p class="recent-posts-subtitle">Scroll through our latest stories with Instagram-like navigation</p>
  </div>
  
  <div class="stories-container-wrapper">
    <!-- Left Navigation Button -->
    <button id="nav-prev-stories" class="nav-btn-side left" disabled>
      <svg class="svg-icon" viewBox="0 0 24 24">
        <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z" fill="currentColor"/>
      </svg>
    </button>
    
    <!-- Main Stories Container -->
    <div class="stories-main-container">
      <div id="recent-posts-container-horizontal" class="horizontal-posts-scroll">
        <!-- Posts will be loaded here -->
      </div>
    </div>
    
    <!-- Right Navigation Button -->
    <button id="nav-next-stories" class="nav-btn-side right">
      <svg class="svg-icon" viewBox="0 0 24 24">
        <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z" fill="currentColor"/>
      </svg>
    </button>
  </div>
  
  <!-- Page Indicators -->
  <div id="page-indicators-stories" class="page-indicators-stories">
    <!-- Dots will be generated here -->
  </div>
</section>

<script>
// Fungsi dengan nama unik untuk menghindari konflik
function getCategoryCandidatesStories(hostname) {      
  const parts = hostname.split('.');      
  if (parts.length < 2) return { sub: null, domain: null };      
  const maybeDomainIndex = parts.length - 3;      
  const domain = (maybeDomainIndex >= 0) ? parts[maybeDomainIndex] : parts[0];      
  const subLabels = (maybeDomainIndex > 0) ? parts.slice(0, maybeDomainIndex) : [];      
  const rawSub = subLabels.length ? subLabels.join('.') : null;      
  const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
  return { sub: rawSub ? normalize(rawSub) : null, domain: domain ? normalize(domain) : null };      
}      

const urlParamsStories = new URLSearchParams(window.location.search);
const initialPageStories = parseInt(urlParamsStories.get('page')) || 1;
const { sub: subCategoryStories, domain: domainCategoryStories } = getCategoryCandidatesStories(window.location.hostname);      
const POSTS_PER_PAGE_STORIES = 6;      
let currentPageStories = initialPageStories;      
let filteredPostsStories = [];      
let autoScrollInterval = null;

// Get initials from title
function getInitials(title) {
  if (!title) return 'A';
  const words = title.split(' ');
  if (words.length === 1) return words[0].charAt(0).toUpperCase();
  return (words[0].charAt(0) + words[1].charAt(0)).toUpperCase();
}

// Format date
function formatDate(dateString) {
  const date = new Date(dateString);
  const now = new Date();
  const diffTime = Math.abs(now - date);
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
  
  if (diffDays === 1) return 'Yesterday';
  if (diffDays < 7) return `${diffDays} days ago`;
  
  return date.toLocaleDateString('en-US', {
    month: 'short',
    day: 'numeric'
  });
}

// Show loading shimmer
function showLoadingStories() {
  const container = document.getElementById('recent-posts-container-horizontal');
  container.innerHTML = '';
  
  for (let i = 0; i < POSTS_PER_PAGE_STORIES; i++) {
    const loadingCard = document.createElement('div');
    loadingCard.className = 'story-card loading-shimmer';
    loadingCard.style.minHeight = '380px';
    container.appendChild(loadingCard);
  }
}

// Setup navigation buttons
function setupNavigation() {
  const prevBtn = document.getElementById('nav-prev-stories');
  const nextBtn = document.getElementById('nav-next-stories');
  const container = document.getElementById('recent-posts-container-horizontal');
  const totalPages = Math.ceil(filteredPostsStories.length / POSTS_PER_PAGE_STORIES);
  
  // Update button states
  prevBtn.disabled = currentPageStories === 1;
  nextBtn.disabled = currentPageStories === totalPages;
  
  // Add click handlers
  prevBtn.onclick = () => {
    if (currentPageStories > 1) {
      changePageStories(currentPageStories - 1);
    }
  };
  
  nextBtn.onclick = () => {
    if (currentPageStories < totalPages) {
      changePageStories(currentPageStories + 1);
    }
  };
  
  // Add keyboard navigation
  document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowLeft' && !prevBtn.disabled) {
      prevBtn.click();
    } else if (e.key === 'ArrowRight' && !nextBtn.disabled) {
      nextBtn.click();
    }
  });
  
  // Add scroll event for auto-hide/show buttons
  container.addEventListener('scroll', () => {
    const scrollLeft = container.scrollLeft;
    const scrollWidth = container.scrollWidth;
    const clientWidth = container.clientWidth;
    
    prevBtn.disabled = scrollLeft === 0;
    nextBtn.disabled = scrollLeft + clientWidth >= scrollWidth - 10;
  });
}

// Setup scroll indicators
function setupScrollIndicators() {
  const container = document.getElementById('recent-posts-container-horizontal');
  const indicatorsContainer = document.getElementById('page-indicators-stories');
  const totalPages = Math.ceil(filteredPostsStories.length / POSTS_PER_PAGE_STORIES);
  
  indicatorsContainer.innerHTML = '';
  
  for (let i = 1; i <= totalPages; i++) {
    const indicator = document.createElement('div');
    indicator.className = `page-dot-story ${i === currentPageStories ? 'active' : ''}`;
    indicator.onclick = () => changePageStories(i);
    indicatorsContainer.appendChild(indicator);
  }
  
  // Auto scroll to current page position
  const scrollPosition = (currentPageStories - 1) * (container.scrollWidth / totalPages);
  container.scrollTo({ left: scrollPosition, behavior: 'smooth' });
}

// Load posts
showLoadingStories();

fetch('/posts.json')      
  .then(res => {      
    if (!res.ok) throw new Error('Failed to load posts.json');      
    return res.json();      
  })      
  .then(posts => {      
    const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
    if (!Array.isArray(posts) || posts.length === 0) return renderNoPostsStories();      

    if (subCategoryStories) {      
      filteredPostsStories = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === subCategoryStories));      
    }      

    if (filteredPostsStories.length === 0 && domainCategoryStories) {      
      filteredPostsStories = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === domainCategoryStories));      
    }      

    if (filteredPostsStories.length === 0) filteredPostsStories = posts;      

    filteredPostsStories.sort((a, b) => new Date(b.date) - new Date(a.date));      
    renderPostsStories();      
  })      
  .catch(err => {      
    console.error('Error loading posts for stories view:', err);      
    renderNoPostsStories();      
  });      

function renderPostsStories() {      
  const container = document.getElementById('recent-posts-container-horizontal');      
  container.innerHTML = '';      

  const start = (currentPageStories - 1) * POSTS_PER_PAGE_STORIES;      
  const end = start + POSTS_PER_PAGE_STORIES;      
  const pagePosts = filteredPostsStories.slice(start, end);      

  pagePosts.forEach((post, index) => {      
    const storyCard = document.createElement('div');      
    storyCard.className = 'story-card';      
    storyCard.style.animationDelay = `${index * 0.2}s`;

    // Story profile circle (like Instagram)
    const profileDiv = document.createElement('div');
    profileDiv.className = 'story-profile';
    const profileIcon = document.createElement('div');
    profileIcon.className = 'story-profile-icon';
    profileIcon.textContent = getInitials(post.title);
    profileDiv.appendChild(profileIcon);
    storyCard.appendChild(profileDiv);

    // Story content container
    const contentDiv = document.createElement('div');
    contentDiv.className = 'story-content';

    // Date
    const dateDiv = document.createElement('div');
    dateDiv.className = 'story-date';
    dateDiv.textContent = formatDate(post.date || new Date());
    contentDiv.appendChild(dateDiv);

    // Title
    const h3 = document.createElement('h3');      
    const linkTitle = document.createElement('a');      
    linkTitle.href = post.url || '#';      
    linkTitle.textContent = post.title || '(no title)';      
    h3.appendChild(linkTitle);      
    contentDiv.appendChild(h3);      

    // Excerpt
    const desc = document.createElement('p');      
    desc.textContent = post.excerpt || 'Click to read this story...';      
    contentDiv.appendChild(desc);

    // Categories
    if (post.categories && post.categories.length > 0) {
      const categoriesDiv = document.createElement('div');
      categoriesDiv.className = 'story-categories';
      
      post.categories.slice(0, 2).forEach(category => {
        const tag = document.createElement('a');
        tag.className = 'story-tag';
        tag.href = '#';
        tag.textContent = `#${category}`;
        categoriesDiv.appendChild(tag);
      });
      
      contentDiv.appendChild(categoriesDiv);
    }

    // Read more button
    const readMoreLink = document.createElement('a');
    readMoreLink.className = 'story-read-more';
    readMoreLink.href = post.url || '#';
    readMoreLink.textContent = 'Read Story ‚Üí';
    contentDiv.appendChild(readMoreLink);

    storyCard.appendChild(contentDiv);
    container.appendChild(storyCard);      
  });      

  setupNavigation();
  setupScrollIndicators();
}      

function changePageStories(page) {
  currentPageStories = page;
  renderPostsStories();
  
  // Update URL tanpa reload
  const newUrl = `${window.location.pathname}?page=${String(page).padStart(2, '0')}`;
  history.pushState({}, '', newUrl);
}

function renderNoPostsStories() {      
  const container = document.getElementById('recent-posts-container-horizontal');      
  const navPrev = document.getElementById('nav-prev-stories');      
  const navNext = document.getElementById('nav-next-stories');      
  const indicators = document.getElementById('page-indicators-stories');      
  
  const noStoriesDiv = document.createElement('div');
  noStoriesDiv.className = 'story-card';
  noStoriesDiv.style.textAlign = 'center';
  noStoriesDiv.style.padding = '3rem 2rem';
  noStoriesDiv.style.minHeight = '380px';
  noStoriesDiv.style.display = 'flex';
  noStoriesDiv.style.flexDirection = 'column';
  noStoriesDiv.style.justifyContent = 'center';
  noStoriesDiv.style.alignItems = 'center';
  
  const profileDiv = document.createElement('div');
  profileDiv.className = 'story-profile';
  profileDiv.innerHTML = 'üìù';
  
  const message = document.createElement('h3');
  message.style.color = '#666';
  message.style.fontSize = '1.2rem';
  message.style.lineHeight = '1.6';
  message.style.marginTop = '2rem';
  message.textContent = 'No stories yet. Be the first to share!';
  
  noStoriesDiv.appendChild(profileDiv);
  noStoriesDiv.appendChild(message);
  container.appendChild(noStoriesDiv);      
  
  navPrev.style.display = 'none';
  navNext.style.display = 'none';
  indicators.style.display = 'none';
}      
</script>
