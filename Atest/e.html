<style>
.recent-posts-horizontal {
  margin: 3rem auto;
  padding: 0 1rem;
  max-width: 1200px;
  position: relative;
}

/* Horizontal scroll container dengan 2 kolom */
.horizontal-posts-scroll {
  display: flex;
  overflow-x: auto;
  gap: 1.5rem;
  padding: 1rem 0.5rem;
  scrollbar-width: thin;
  scrollbar-color: #ccc transparent;
  -webkit-overflow-scrolling: touch;
  scroll-behavior: smooth;
}

/* Tampilkan 2 kolom dalam viewport */
.horizontal-posts-scroll .post-card-horizontal {
  width: calc(50% - 0.75rem); /* 2 kolom dengan gap */
  min-width: calc(50% - 0.75rem); /* Tetap 2 kolom meski discroll */
  max-width: calc(50% - 0.75rem);
  flex-shrink: 0;
}

/* Hide scrollbar styling */
.horizontal-posts-scroll::-webkit-scrollbar {
  height: 6px;
}
.horizontal-posts-scroll::-webkit-scrollbar-track {
  background: #f1f1f1;
  border-radius: 10px;
}
.horizontal-posts-scroll::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 10px;
}
.horizontal-posts-scroll::-webkit-scrollbar-thumb:hover {
  background: #aaa;
}

/* Post card styles untuk tampilan horizontal */
.post-card-horizontal {
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.08);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  padding: 1.5rem 1.2rem;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
}
.post-card-horizontal:hover {
  transform: translateY(-5px);
  box-shadow: 0 6px 14px rgba(0,0,0,0.1);
}
.post-card-horizontal h3 {
  font-size: 1.2rem;
  margin-bottom: 0.75rem;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.post-card-horizontal h3 a {
  text-decoration: none;
  color: #222;
  transition: color 0.2s ease;
}
.post-card-horizontal h3 a:hover {
  color: var(--dynamic-color, #0078ff);
}
.post-card-horizontal p {
  font-size: 0.95rem;
  line-height: 1.6;
  color: #555;
  margin: 0;
  display: -webkit-box;
  -webkit-line-clamp: 3;
  -webkit-box-orient: vertical;
  overflow: hidden;
}

/* Instagram Style Pagination dengan icon */
.pagination-horizontal-instagram {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  margin-top: 2rem;
  padding: 0.5rem;
  width: 100%;
  box-sizing: border-box;
}

.pagination-horizontal-instagram button {
  background: var(--dynamic-color, #0078ff);
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  font-size: 1.2rem;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.pagination-horizontal-instagram button:hover:not(:disabled) {
  background: #005ec7;
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.pagination-horizontal-instagram button:disabled {
  background: #e0e0e0;
  color: #999;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

/* Navigation buttons - Instagram style */
.nav-btn-prev::before {
  content: "〈";
}

.nav-btn-next::before {
  content: "〉";
}

/* Page indicator dots - Instagram story style */
.page-indicators {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  justify-content: center;
}

.page-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  background-color: #ddd;
  transition: all 0.3s ease;
  cursor: pointer;
}

.page-dot.active {
  background-color: var(--dynamic-color, #0078ff);
  width: 24px;
  border-radius: 4px;
}

.page-dot:hover {
  background-color: #bbb;
}

/* Responsive adjustments */
@media (max-width: 768px) {
  /* Pada tablet kecil, tetap 2 kolom */
  .horizontal-posts-scroll .post-card-horizontal {
    width: calc(50% - 0.75rem);
    min-width: calc(50% - 0.75rem);
    max-width: calc(50% - 0.75rem);
  }
  
  .pagination-horizontal-instagram button {
    width: 40px;
    height: 40px;
    font-size: 1.1rem;
  }
}

@media (max-width: 600px) {
  .pagination-horizontal-instagram {
    gap: 0.8rem;
  }
  
  .pagination-horizontal-instagram button {
    width: 36px;
    height: 36px;
    font-size: 1rem;
  }
  
  /* Pada mobile kecil, 1 kolom saja */
  .horizontal-posts-scroll .post-card-horizontal {
    width: calc(100% - 0.75rem);
    min-width: calc(100% - 0.75rem);
    max-width: calc(100% - 0.75rem);
  }
  
  .page-dot {
    width: 6px;
    height: 6px;
  }
  
  .page-dot.active {
    width: 20px;
  }
}
</style>

<section class="recent-posts-horizontal">      
  <div id="recent-posts-container-horizontal" class="horizontal-posts-scroll"></div>      
  <div id="pagination-horizontal-instagram" class="pagination-horizontal-instagram"></div>      
</section>      

<script>
// Fungsi dengan nama unik untuk menghindari konflik
function getCategoryCandidatesHorizontal(hostname) {      
  const parts = hostname.split('.');      
  if (parts.length < 2) return { sub: null, domain: null };      
  const maybeDomainIndex = parts.length - 3;      
  const domain = (maybeDomainIndex >= 0) ? parts[maybeDomainIndex] : parts[0];      
  const subLabels = (maybeDomainIndex > 0) ? parts.slice(0, maybeDomainIndex) : [];      
  const rawSub = subLabels.length ? subLabels.join('.') : null;      
  const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
  return { sub: rawSub ? normalize(rawSub) : null, domain: domain ? normalize(domain) : null };      
}      

const urlParamsHorizontal = new URLSearchParams(window.location.search);
const initialPageHorizontal = parseInt(urlParamsHorizontal.get('page')) || 1;
const { sub: subCategoryHorizontal, domain: domainCategoryHorizontal } = getCategoryCandidatesHorizontal(window.location.hostname);      
const POSTS_PER_PAGE_HORIZONTAL = 6;      
let currentPageHorizontal = initialPageHorizontal;      
let filteredPostsHorizontal = [];      

// Gunakan fetch dengan error handling yang lebih baik
fetch('/posts.json')      
  .then(res => {      
    if (!res.ok) throw new Error('Failed to load posts.json');      
    return res.json();      
  })      
  .then(posts => {      
    const normalize = s => String(s || '').replace(/[-.]+/g, ' ').replace(/\s+/g, ' ').trim().toLowerCase();      
    if (!Array.isArray(posts) || posts.length === 0) return renderNoPostsHorizontal();      

    if (subCategoryHorizontal) {      
      filteredPostsHorizontal = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === subCategoryHorizontal));      
    }      

    if (filteredPostsHorizontal.length === 0 && domainCategoryHorizontal) {      
      filteredPostsHorizontal = posts.filter(p => Array.isArray(p.categories) && p.categories.some(c => normalize(c) === domainCategoryHorizontal));      
    }      

    if (filteredPostsHorizontal.length === 0) filteredPostsHorizontal = posts;      

    filteredPostsHorizontal.sort((a, b) => new Date(b.date) - new Date(a.date));      
    renderPostsHorizontal();      
  })      
  .catch(err => {      
    console.error('Error loading posts for horizontal view:', err);      
    renderNoPostsHorizontal();      
  });      

function renderPostsHorizontal() {      
  const container = document.getElementById('recent-posts-container-horizontal');      
  const pagination = document.getElementById('pagination-horizontal-instagram');      
  container.innerHTML = '';      
  pagination.innerHTML = '';      

  const start = (currentPageHorizontal - 1) * POSTS_PER_PAGE_HORIZONTAL;      
  const end = start + POSTS_PER_PAGE_HORIZONTAL;      
  const pagePosts = filteredPostsHorizontal.slice(start, end);      

  pagePosts.forEach(post => {      
    const card = document.createElement('div');      
    card.className = 'post-card-horizontal';      

    const h3 = document.createElement('h3');      
    const linkTitle = document.createElement('a');      
    linkTitle.href = post.url || '#';      
    linkTitle.textContent = post.title || '(no title)';      
    h3.appendChild(linkTitle);      
    card.appendChild(h3);      

    const desc = document.createElement('p');      
    desc.textContent = post.excerpt || '(no excerpt available)';      
    card.appendChild(desc);      

    container.appendChild(card);      
  });      

  const totalPages = Math.ceil(filteredPostsHorizontal.length / POSTS_PER_PAGE_HORIZONTAL);      
  if (totalPages > 1) {      
    // Tombol Previous
    const prevBtn = document.createElement('button');      
    prevBtn.className = 'nav-btn-prev';      
    prevBtn.title = 'Previous page';      
    prevBtn.disabled = currentPageHorizontal === 1;      
    prevBtn.onclick = () => changePageHorizontal(currentPageHorizontal - 1);      
    pagination.appendChild(prevBtn);      

    // Dots indicator (Instagram style)
    const dotsContainer = document.createElement('div');      
    dotsContainer.className = 'page-indicators';      
    
    for (let i = 1; i <= totalPages; i++) {
      const dot = document.createElement('div');      
      dot.className = `page-dot ${i === currentPageHorizontal ? 'active' : ''}`;      
      dot.title = `Page ${i}`;      
      dot.onclick = () => changePageHorizontal(i);      
      dotsContainer.appendChild(dot);      
    }
    
    pagination.appendChild(dotsContainer);      

    // Tombol Next
    const nextBtn = document.createElement('button');      
    nextBtn.className = 'nav-btn-next';      
    nextBtn.title = 'Next page';      
    nextBtn.disabled = currentPageHorizontal === totalPages;      
    nextBtn.onclick = () => changePageHorizontal(currentPageHorizontal + 1);      
    pagination.appendChild(nextBtn);      
  } else {
    // Jika hanya 1 halaman, sembunyikan pagination
    pagination.style.display = 'none';
  }
}      

function changePageHorizontal(page) {
  currentPageHorizontal = page;
  renderPostsHorizontal();
  
  // Update URL tanpa reload
  const newUrl = `${window.location.pathname}?page=${String(page).padStart(2, '0')}`;
  history.pushState({}, '', newUrl);
  
  // Scroll ke atas kontainer
  const container = document.getElementById('recent-posts-container-horizontal');
  if (container) {
    container.scrollTo({ left: 0, behavior: 'smooth' });
  }
}

function renderNoPostsHorizontal() {      
  const container = document.getElementById('recent-posts-container-horizontal');      
  const pagination = document.getElementById('pagination-horizontal-instagram');      
  container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #666;">No posts found.</p>';      
  pagination.style.display = 'none';      
}      
</script>
