---
---

{% assign tags_list = site.tags %}
{% assign sorted_tags = tags_list | sort %}

<div id="tags-box">
  <!-- SEMUA tags ditampilkan (visible untuk SEO) -->
  <div id="all-tags-container">
    {% for tag in sorted_tags %}
      {% assign tagname = tag[0] %}
      {% assign posts_in_tag = tag[1] %}
      {% assign tag_count = posts_in_tag | size %}
      
      <a class="taglink all-tag" 
         href="https://{{ tagname | replace:' ','-' | downcase }}.{{ site.url | remove: 'https://' | remove: 'http://' | split: '/' | first }}"
         style="display:block; margin:6px 0; {% if forloop.index > 20 %}opacity:0.7; height:0; overflow:hidden; margin:0;{% endif %}">
        {{ tagname | replace:"-"," " }} ({{ tag_count }})
      </a>
    {% endfor %}
  </div>
  
  {% if sorted_tags.size > 20 %}
    <div style="text-align:center; margin:15px 0;">
      <button id="view-more-tags" 
              style="padding:8px 20px; background:#fff; border:2px solid #007bff; color:#007bff; border-radius:20px; cursor:pointer; font-weight:bold;">
        ↓ View All {{ sorted_tags.size }} Tags ↓
      </button>
      <div style="font-size:12px; color:#666; margin-top:5px;">
        (Showing 20 of {{ sorted_tags.size }} tags)
      </div>
    </div>
  {% endif %}
</div>

<style>
  #all-tags-container {
    max-height: 500px;
    overflow: hidden;
    transition: max-height 0.5s ease;
  }
  
  #all-tags-container.expanded {
    max-height: none;
  }
  
  .all-tag {
    transition: all 0.3s ease;
  }
</style>

<script>
document.addEventListener("DOMContentLoaded", function(){
  // Set URL untuk semua tags
  document.querySelectorAll(".all-tag").forEach(function(tag){
    var text = tag.textContent.split(' (')[0];
    var slug = text.replace(/\s+/g, '-').toLowerCase();
    tag.href = "https://" + slug + "." + window.location.host;
  });
  
  // View More functionality
  var viewMoreBtn = document.getElementById("view-more-tags");
  var tagsContainer = document.getElementById("all-tags-container");
  var allTags = document.querySelectorAll(".all-tag");
  
  if(viewMoreBtn && tagsContainer){
    var isExpanded = false;
    
    viewMoreBtn.addEventListener("click", function(){
      if(!isExpanded){
        // Expand
        tagsContainer.classList.add("expanded");
        viewMoreBtn.textContent = "↑ Collapse Tags ↑";
        viewMoreBtn.style.borderColor = "#dc3545";
        viewMoreBtn.style.color = "#dc3545";
        
        // Animate hidden tags
        allTags.forEach(function(tag, index){
          if(index >= 20){
            setTimeout(function(){
              tag.style.height = "auto";
              tag.style.opacity = "1";
              tag.style.margin = "6px 0";
            }, (index - 20) * 10);
          }
        });
        
        isExpanded = true;
      } else {
        // Collapse
        tagsContainer.classList.remove("expanded");
        viewMoreBtn.textContent = "↓ View All {{ sorted_tags.size }} Tags ↓";
        viewMoreBtn.style.borderColor = "#007bff";
        viewMoreBtn.style.color = "#007bff";
        
        // Reset styles untuk tags > 20
        allTags.forEach(function(tag, index){
          if(index >= 20){
            tag.style.height = "0";
            tag.style.opacity = "0.7";
            tag.style.margin = "0";
          }
        });
        
        isExpanded = false;
        
        // Scroll ke atas
        setTimeout(function(){
          tagsContainer.scrollIntoView({behavior: "smooth"});
        }, 300);
      }
    });
  }
});
</script>
  
