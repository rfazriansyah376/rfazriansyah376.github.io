<div id="random-content2">
  <div style="text-align:center; padding:20px;">
    Memuat konten...
  </div>
</div>

<script>
(function() {
  const container = document.getElementById('random-content2');
  if (!container) return;

  async function loadRandomContent() {
    try {
      // 1. Ambil daftar file dari GitHub API (bukan dari includes.json)
      const response = await fetch('https://api.github.com/repos/nengmaya538/nengmaya538.github.io/contents/includes');
      
      if (!response.ok) {
        throw new Error('Gagal mengambil daftar file');
      }
      
      const files = await response.json();
      
      // 2. Filter hanya file .html (case insensitive)
      const htmlFiles = files.filter(file => 
        file.name.toLowerCase().endsWith('.html') && 
        file.type === 'file'
      );
      
      if (htmlFiles.length === 0) {
        throw new Error('Tidak ada file HTML di folder includes');
      }
      
      // 3. Pilih satu file secara acak
      const randomIndex = Math.floor(Math.random() * htmlFiles.length);
      const selectedFile = htmlFiles[randomIndex];
      
      console.log(`Memilih file: ${selectedFile.name}`);
      
      // 4. Ambil konten file via jsDelivr CDN (no CORS)
      const contentUrl = `https://cdn.jsdelivr.net/gh/nengmaya538/nengmaya538.github.io/includes/${selectedFile.name}`;
      const contentResponse = await fetch(contentUrl + '?nocache=' + Date.now());
      
      if (!contentResponse.ok) {
        throw new Error(`Gagal mengambil konten ${selectedFile.name}`);
      }
      
      const html = await contentResponse.text();
      
      // 5. Tampilkan konten
      container.innerHTML = html;
      
      // 6. Eksekusi script yang ada di dalam konten (jika ada)
      const scripts = container.getElementsByTagName('script');
      for (let i = scripts.length - 1; i >= 0; i--) {
        const oldScript = scripts[i];
        const newScript = document.createElement('script');
        
        if (oldScript.src) {
          newScript.src = oldScript.src;
        } else {
          newScript.textContent = oldScript.textContent;
        }
        
        oldScript.parentNode.replaceChild(newScript, oldScript);
      }
      
    } catch (error) {
      console.error('Error:', error);
      container.innerHTML = `
        <div style="padding:20px; text-align:center; font-family:system-ui, sans-serif;">
          <p style="color:#666;">Maaf, konten tidak dapat dimuat.</p>
          <p style="font-size:14px; color:#999;">${error.message}</p>
          <button onclick="location.reload()" style="padding:8px 20px; background:#4CAF50; color:white; border:none; border-radius:5px; cursor:pointer;">
            Coba Lagi
          </button>
        </div>
      `;
    }
  }

  // Jalankan
  loadRandomContent();
})();
</script>
